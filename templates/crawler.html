{% include './layout/header.html' %}
<script>
  var input_num = 0;
  const add_textbox = () => {
    const box = document.getElementById("tag_input");
    const newP = document.createElement('spen');
    newP.innerHTML =  '<div class="card mb-3 col-4 disply_ini">' +
                      '<div class="form-floating">' +
                      '<input class="form-control" id="tag' + input_num +'" name="tag' + input_num +'" type="text"/>' +
                      '<label for="tag' + input_num +'">Search tag</label>' +
                      '</div>' +
                      '<div class="form-floating">' +
                      '<input class="form-control" id="name' + input_num +'" name="name' + input_num +'" type="text"/>' +
                      '<label for="name' + input_num +'">Class Name</label>' +
                      '</div>' +
                      '</div>'
    box.appendChild(newP);
    input_num ++
  }
</script>
<section class="page-section" id="contact" style="padding: 0px;margin: 100px;">
    <a class="btn btn-primary" href="/">처음으로</a>
    <div class="container px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-lg-8 col-xl-6 text-center">
                <h2 class="mt-0">크롤링 Page</h2>
                <hr class="divider" />
                <p class="text-muted" style="margin: 1.5rem auto;">이 페이지에서는 크롤링한 Text 확인가능함</p>
            </div>
        </div>
    </div>

    <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-lg-6">
            <form id="contactForm" action="/crawler" method="POST">
              <!-- Submit Button-->
              <div class="col-12 mb-3">
                <input class="btn btn-primary col-auto" id="submitButton" value="크롤링 시작" type="submit"/>
                <input class="btn btn-primary col-auto" type="button" value="태그 추가" onclick="add_textbox()"/>
              </div>
              <!-- url input-->
              <div class="form-floating mb-3">
                <input class="form-control" id="url" name="url" type="text" required/>
                <label for="url">Search url</label>
              </div>
              <!-- tag input-->
              <div id="tag_input">
              </div>
            </form>
        </div>
    </div>

    <div class="container px-4 px-lg-5" style="margin-top: 30px;">
      <div class="row gx-4 gx-lg-5 justify-content-center">
        <div class="col-lg-8 col-xl-6 text-center">
          {% if result.code == 20000 %}
            <div class="text-center card">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th scope="col">Name</th>
                    <th scope="col">Result</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row">url</th>
                    <td>{{result.url}}</td>
                  </tr>
                  <tr>
                    <th scope="row">tag</th>
                    <td>
                      {{result.tag}}
                    </td>
                  </tr>
                  <tr>
                    <th scope="row">class</th>
                    <td>
                      {{result.classNm}}
                    </td>
                  </tr>
                  {% for result_txt in result.result_txt %}
                  <tr>
                    <th scope="row">txt</th>
                    <td>
                      {{result_txt}}
                    </td>
                  </tr>
                  {% endfor %}
                  <tr>
                    <th scope="row">Image</th>
                    <td>
                      {% for img in result.result_img %}
                        <img src="{{img}}" style="width: 30%;">
                      {% endfor %}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          {% elif result.code == 40000 %}
            <a href={{url}}><p class="text-muted" style="margin: 10px;">url : {{result.url}}</p></a>
            <p class="text-muted" style="margin-bottom: 10px;">크롤링에 실패하였습니다.</p>
            <p class="text-muted" style="margin-bottom: 10px;">검색한 Url이나 HTML 태그가 존재 하는지 확인해주세요.</p>
          {% endif %}
      </div>
    </div>
  </div>
</section>
{% include './layout/footer.html' %}